<!DOCTYPE html>
<html lang="en">

<head>
  <!-- Required meta tags -->
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <title>Star Admin2 </title>
  <!-- plugins:css -->
  <link rel="stylesheet" href="./dist/assets/vendors/feather/feather.css">
  <link rel="stylesheet" href="./dist/assets/vendors/mdi/css/materialdesignicons.min.css">
  <link rel="stylesheet" href="./dist/assets/vendors/ti-icons/css/themify-icons.css">
  <link rel="stylesheet" href="./dist/assets/vendors/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="./dist/assets/vendors/typicons/typicons.css">
  <link rel="stylesheet" href="./dist/assets/vendors/simple-line-icons/css/simple-line-icons.css">
  <link rel="stylesheet" href="./dist/assets/vendors/css/vendor.bundle.base.css">
  <link rel="stylesheet" href="./dist/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.css">
  <!-- endinject -->
  <!-- Plugin css for this page -->
  <link rel="stylesheet" href="assets/vendors/datatables.net-bs4/dataTables.bootstrap4.css">
  <link rel="stylesheet" type="text/css" href="assets/js/select.dataTables.min.css">
  <!-- End plugin css for this page -->
  <!-- inject:css -->
  <link rel="stylesheet" href="./dist/assets/css/style.css">
  <!-- endinject -->
  <link rel="shortcut icon" href="./dist/assets/images/favicon.png" />
</head>

<body class="with-welcome-text">
  <div class="container-scroller">

    <!-- partial:partials/_navbar.html -->
    <nav class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex align-items-top flex-row">
      <div class="text-center navbar-brand-wrapper d-flex align-items-center justify-content-start">
        <div class="me-3">
          <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-bs-toggle="minimize">
            <span class="icon-menu"></span>
          </button>
        </div>
        <div>
          <a class="navbar-brand brand-logo" href="index.html">
            <img src="./dist/assets/images/logo.svg" alt="logo" />
          </a>
          <a class="navbar-brand brand-logo-mini" href="index.html">
            <img src="./dist/assets/images/logo-mini.svg" alt="logo" />
          </a>
        </div>
      </div>
      <div class="navbar-menu-wrapper d-flex align-items-top">
        <ul class="navbar-nav">
          <li class="nav-item fw-semibold d-none d-lg-block ms-0">
            <h1 class="welcome-text">Good Morning, <span class="text-black fw-bold">John Doe</span></h1>
            <h3 class="welcome-sub-text">Your performance summary this week </h3>
          </li>
        </ul>
        <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button"
          data-bs-toggle="offcanvas">
          <span class="mdi mdi-menu"></span>
        </button>
      </div>
    </nav>
    <!-- partial -->
    <div class="container-fluid page-body-wrapper">
      <!-- partial:partials/_sidebar.html -->
      <nav class="sidebar sidebar-offcanvas" id="sidebar">
        <ul class="nav">
          <li class="nav-item">
            <a class="nav-link" href="index.html">
              <i class="mdi mdi-grid-large menu-icon"></i>
              <span class="menu-title">Dashboard</span>
            </a>
          </li>
          <li class="nav-item nav-category">UI Elements</li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#ui-basic" aria-expanded="false"
              aria-controls="ui-basic">
              <i class="menu-icon mdi mdi-floor-plan"></i>
              <span class="menu-title">UI Elements</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="ui-basic">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="./dist/pages/ui-features/buttons.html">Buttons</a></li>
                <li class="nav-item"> <a class="nav-link" href="./dist/pages/ui-features/dropdowns.html">Dropdowns</a>
                </li>
                <li class="nav-item"> <a class="nav-link" href="./dist/pages/ui-features/typography.html">Typography</a>
                </li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#form-elements" aria-expanded="false"
              aria-controls="form-elements">
              <i class="menu-icon mdi mdi-card-text-outline"></i>
              <span class="menu-title">Form elements</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="form-elements">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"><a class="nav-link" href="pages/forms/basic_elements.html">Basic Elements</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#charts" aria-expanded="false" aria-controls="charts">
              <i class="menu-icon mdi mdi-chart-line"></i>
              <span class="menu-title">Charts</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="charts">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/charts/chartjs.html">ChartJs</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#tables" aria-expanded="false" aria-controls="tables">
              <i class="menu-icon mdi mdi-table"></i>
              <span class="menu-title">Tables</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="tables">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/tables/basic-table.html">Basic table</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#icons" aria-expanded="false" aria-controls="icons">
              <i class="menu-icon mdi mdi-layers-outline"></i>
              <span class="menu-title">Icons</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="icons">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/icons/font-awesome.html">Font Awesome</a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" data-bs-toggle="collapse" href="#auth" aria-expanded="false" aria-controls="auth">
              <i class="menu-icon mdi mdi-account-circle-outline"></i>
              <span class="menu-title">User Pages</span>
              <i class="menu-arrow"></i>
            </a>
            <div class="collapse" id="auth">
              <ul class="nav flex-column sub-menu">
                <li class="nav-item"> <a class="nav-link" href="pages/samples/blank-page.html"> Blank Page </a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/samples/error-404.html"> 404 </a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/samples/error-500.html"> 500 </a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/samples/login.html"> Login </a></li>
                <li class="nav-item"> <a class="nav-link" href="pages/samples/register.html"> Register </a></li>
              </ul>
            </div>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="docs/documentation.html">
              <i class="menu-icon mdi mdi-file-document"></i>
              <span class="menu-title">Documentation</span>
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="">
              <i class="menu-icon mdi mdi-logout"></i>
              <span><button class="menu-title btn " id="logoutButton">Logout</button></span>
            </a>
          </li>
        </ul>
      </nav>
      <!-- partial -->
      <div class="main-panel">
        <div class="content-wrapper">
          <div class="row">
            <div class="col-sm-12">
              <div class="home-tab">
                <div class="tab-content tab-content-basic">
                  <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview">
                    <div class="container my-5">
                      <div class="row justify-content-center">
                        <div class="col-md-8">
                          <div class="card shadow-sm rounded">
                            <div class="card-body">
                              <h4 class="card-title text-primary">Add a New Job</h4>
                              <p class="card-description">Provide job details in the form below</p>
                              <form id="jobForm">

                                <!-- Job Title Field -->
                                <div class="form-group mb-3">
                                  <label for="jobTitle" class="form-label">Job Title</label>
                                  <div class="input-group">
                                    <span class="input-group-text bg-primary text-white"><i
                                        class="mdi mdi-briefcase"></i></span>
                                    <input type="text" class="form-control" id="jobTitle" placeholder="Enter job title"
                                      required>
                                  </div>
                                </div>

                                <!-- Job Description Field -->
                                <div class="form-group mb-3">
                                  <label for="jobDescription" class="form-label">Job Description</label>
                                  <div class="input-group">
                                    <span class="input-group-text bg-primary text-white"><i
                                        class="mdi mdi-file-document"></i></span>
                                    <textarea class="form-control" id="jobDescription" rows="4"
                                      placeholder="Enter job description" required></textarea>
                                  </div>
                                </div>

                                <!-- Company Name Field -->
                                <div class="form-group mb-3">
                                  <label for="companyName" class="form-label">Company Name</label>
                                  <div class="input-group">
                                    <span class="input-group-text bg-primary text-white"><i
                                        class="mdi mdi-domain"></i></span>
                                    <input type="text" class="form-control" id="companyName"
                                      placeholder="Enter company name" required>
                                  </div>
                                </div>

                                <!-- Job Location Field -->
                                <div class="form-group mb-3">
                                  <label for="jobLocation" class="form-label">Job Location</label>
                                  <div class="input-group">
                                    <span class="input-group-text bg-primary text-white"><i
                                        class="mdi mdi-map-marker-circle"></i></span>
                                    <input type="text" class="form-control" id="jobLocation"
                                      placeholder="Enter job location" required>
                                  </div>
                                </div>

                                <!-- Job Type Field -->
                                <div class="form-group mb-3">
                                  <label for="jobType" class="form-label">Job Type</label>
                                  <div class="input-group">
                                    <span class="input-group-text bg-primary text-white"><i
                                        class="mdi mdi-help-circle-outline"></i></span>
                                    <select class="form-select" id="jobType" required>
                                      <option disabled selected>Select job type</option>
                                      <option>Full-Time</option>
                                      <option>Part-Time</option>
                                      <option>Contract</option>
                                      <option>Internship</option>
                                    </select>
                                  </div>
                                </div>

                                <!-- Dynamic Sections Container -->
                                <div id="sectionsContainer" class="my-3"></div>
                                <button type="button" class="btn btn-primary mb-3" onclick="addSection()">Add
                                  Section</button>

                                <!-- Form Buttons -->
                                <div class="d-flex justify-content-between">
                                  <button type="submit" class="btn btn-success btn-icon-text">
                                    <i class="mdi mdi-check btn-icon-prepend"></i> Submit
                                  </button>
                                  <button type="reset" class="btn btn-light btn-icon-text">
                                    <i class="mdi mdi-close btn-icon-prepend"></i> Cancel
                                  </button>
                                </div>
                              </form>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="container my-5">
                        <h4 class="card-title text-primary">All Jobs</h4>
                        <div id="jobList" class="list-group mb-5">
                          <!-- Jobs will be dynamically injected here -->
                        </div>
                      </div>

                    </div>


                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- content-wrapper ends -->
      <!-- partial:partials/_footer.html -->
      <!-- partial -->
    </div>
    <!-- main-panel ends -->
  </div>
  <!-- page-body-wrapper ends -->
  </div>
  <!-- container-scroller -->
  <!-- plugins:js -->
  <script src="./dist/assets/vendors/js/vendor.bundle.base.js"></script>
  <script src="./dist/assets/vendors/bootstrap-datepicker/bootstrap-datepicker.min.js"></script>
  <!-- endinject -->
  <!-- Plugin js for this page -->
  <script src="./dist/assets/vendors/chart.js/chart.umd.js"></script>
  <script src="./dist/assets/vendors/progressbar.js/progressbar.min.js"></script>
  <!-- End plugin js for this page -->
  <!-- inject:js -->
  <script src="./dist/assets/js/off-canvas.js"></script>
  <script src="./dist/assets/js/template.js"></script>
  <script src="./dist/assets/js/settings.js"></script>
  <script src="./dist/assets/js/hoverable-collapse.js"></script>
  <script src="./dist/assets/js/todolist.js"></script>
  <!-- endinject -->
  <!-- Custom js for this page-->
  <script src="./dist/assets/js/jquery.cookie.js" type="text/javascript"></script>
  <script src="./dist/assets/js/dashboard.js"></script>
  <!-- <script src="assets/js/Chart.roundedBarCharts.js"></script> -->
  <!-- End custom js for this page-->

  <script>
    // Add the addSection function here
    function addSection(header = "", content = "") {
      const sectionCount = document.querySelectorAll('#sectionsContainer .card').length + 1;

      const section = document.createElement("div");
      section.className = "card mb-3";
      section.innerHTML = `
        <div class="card-header">
            <input type="text" class="form-control" placeholder="Section Header ${sectionCount}" value="${header}">
        </div>
        <div class="card-body">
            <textarea class="form-control" rows="3" placeholder="Section Content">${content}</textarea>
            <button type="button" class="btn btn-danger mt-2" onclick="removeSection(this)">Remove Section</button>
        </div>
      `;

      document.getElementById("sectionsContainer").appendChild(section);
    }

    // Function to remove sections
    function removeSection(button) {
      button.closest('.card').remove();
    }




    document.getElementById('logoutButton').addEventListener('click', function () {
      // Remove JWT from localStorage (or cookies if you're using that)
      localStorage.removeItem('token');  // or document.cookie = "token=; Max-Age=-99999999;"; for cookies

      // Optionally redirect to login page after logout
      window.location.href = '/adminDashboard/dist/pages/samples/login.html';
    });

    // Check if the user is logged in before accessing a page
    const token = localStorage.getItem('token');
    if (!token) {
      window.location.href = '/login.html';
    }


    function loadJobs() {
      fetch('http://localhost:5000/api/jobs')
        .then(response => response.json())
        .then(data => {
          const jobList = document.getElementById('jobList');
          jobList.innerHTML = ''; // Clear the job list

          data.forEach(job => {
            const jobItem = document.createElement('div');
            jobItem.classList.add('list-group-item', 'job-item');
            jobItem.innerHTML = `
          <div class="d-flex justify-content-between align-items-center">
            <div>
              <h5>${job.title}</h5>
              <p>${job.description}</p>
              <p><strong>Company:</strong> ${job.companyName} | <strong>Location:</strong> ${job.location}</p>
            </div>
            <div>
              <button class="btn btn-warning btn-sm" onclick="editJob('${job._id}')">Edit</button>
              <button class="btn btn-danger btn-sm" onclick="deleteJob('${job._id}')">Delete</button>
            </div>
          </div>
        `;
            jobList.appendChild(jobItem);
          });
        })
        .catch(error => {
          console.error('Error fetching jobs:', error);
          alert('Failed to load jobs.');
        });
    }


    // Delete a job
    function deleteJob(id) {
      if (confirm('Are you sure you want to delete this job?')) {
        fetch(`http://localhost:5000/api/jobs/${id}`, {
          method: 'DELETE',
        })
          .then(response => response.json())
          .then(data => {
            alert(data.message);
            loadJobs(); // Reload the jobs list
          })
          .catch(error => {
            console.error('Error deleting job:', error);
            alert('Failed to delete job.');
          });
      }
    }

    // Edit a job (prefill the form with job details)
    function editJob(id) {
      fetch(`http://localhost:5000/api/jobs/${id}`)
        .then(response => {
          if (!response.ok) {
            throw new Error('Job not found');
          }
          return response.json();
        })
        .then(job => {
          // Prefill the form with job details
          document.getElementById('jobTitle').value = job.title;
          document.getElementById('jobDescription').value = job.description;
          document.getElementById('companyName').value = job.companyName;
          document.getElementById('jobLocation').value = job.location;
          document.getElementById('jobType').value = job.jobType;

          // Set form to editing mode by storing the job ID in the dataset
          document.getElementById('jobForm').dataset.editingId = job._id;

          // Clear any existing sections and add the ones from the job
          document.getElementById('sectionsContainer').innerHTML = ''; // Clear sections
          if (job.sections) {
            job.sections.forEach(section => addSection(section.header, section.content));
          }
        })
        .catch(error => {
          console.error('Error fetching job details:', error);
          alert('Failed to load job details.');
        });
    }


    // Modify form submission to handle both creation and update
    document.getElementById('jobForm').addEventListener('submit', function (event) {
      event.preventDefault();

      const jobData = {
        title: document.getElementById('jobTitle').value,
        description: document.getElementById('jobDescription').value,
        companyName: document.getElementById('companyName').value,
        location: document.getElementById('jobLocation').value,
        jobType: document.getElementById('jobType').value,
        requirements: 'Requirements data', // You can modify this as needed
        salary: 'Salary data', // Modify or collect from the form if needed
        sections: [] // Collect sections from the form
      };

      // Collect dynamic sections from the form
      document.querySelectorAll('#sectionsContainer .card').forEach(card => {
        const header = card.querySelector('input[type="text"]').value;
        const content = card.querySelector('textarea').value;
        if (header && content) {
          jobData.sections.push({ header, content });
        }
      });

      // Check if we are in "edit" mode by checking if an ID exists in the dataset
      const editingId = document.getElementById('jobForm').dataset.editingId;
      const method = editingId ? 'PUT' : 'POST';
      const url = editingId ? `http://localhost:5000/api/jobs/${editingId}` : 'http://localhost:5000/api/jobs';

      fetch(url, {
        method: method,
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(jobData),
      })
        .then(response => {
          if (!response.ok) {
            throw new Error('Failed to save job');
          }
          return response.json();
        })
        .then(data => {
          alert(editingId ? 'Job updated successfully!' : 'Job created successfully!');
          document.getElementById('jobForm').reset(); // Clear the form after successful save
          delete document.getElementById('jobForm').dataset.editingId; // Clear editing state
          loadJobs(); // Reload the job list
        })
        .catch(error => {
          console.error('Error saving job:', error);
          alert('Failed to save job.');
        });
    });

    // Load all jobs when the page loads
    window.onload = loadJobs;

  </script>



</body>

</html>